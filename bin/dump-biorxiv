#!/usr/bin/env python3
"""Dump bioRxiv data in JSONL format."""
import os
import json
import argparse
from paper_scraper.xrxiv.xrxiv_api import BioRxivApi

# define the parser arguments
parser = argparse.ArgumentParser()
parser.add_argument(
    'output_filepath', type=str, help='path to JSONL file where the dump is stored.'
)

if __name__ == '__main__':
    # parse arguments
    args = parser.parse_args()
    output_filepath = args.output_filepath
    # create API client
    api = BioRxivApi()
    # dump all papers
    with open(output_filepath, 'w') as fp:
        for index, paper in enumerate(api.get_papers()):
            if index > 1:
                fp.write(os.linesep)
            fp.write(json.dumps(paper))
